<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.1.3. Statistical analysis of the Fourier spectrum for time delay (tau). &mdash; teaspoon 0.1.0 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.1.4. Permutation Auto Mutual Information (PAMI) for time delay (tau)." href="PAMI.html" />
    <link rel="prev" title="2.1.2. Auto-correlation for time delay (tau)." href="AC.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
            <a href="index.html" class="icon icon-home"> teaspoon<img src="_static/teaspoon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">1.1. Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation">1.2. Installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">2. Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="parameter_selection.html">2.1. Parameter Selection Module</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="MI.html">2.1.1. Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="AC.html">2.1.2. Auto-correlation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.1.3. Fourier Spectrum Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="PAMI.html">2.1.4. Permutation Auto Mutual Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="MsPE.html">2.1.5. Multi-scale Permutation Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="FNN.html">2.1.6. False Nearest Neighbors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ML.html">2.2. Machine Learning (ML) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="F_PD.html">2.2.1. Featurization</a></li>
<li class="toctree-l3"><a class="reference internal" href="CL.html">2.2.2. Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="ML.html#references">2.2.3. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TDA.html">2.3. Topological Data Analaysis (TDA) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PHN.html">2.3.1. Persistent Homology of Networks (PHN) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="distances.html">2.3.2. Distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="drawing.html">2.3.3. Drawing</a></li>
<li class="toctree-l3"><a class="reference internal" href="persistence.html">2.3.4. Persistence</a></li>
<li class="toctree-l3"><a class="reference internal" href="sublevel_set_persistence.html">2.3.5. Zero Dimensional Sublevel Set Persistence (SLSP) Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SP.html">2.4. Signal Processing (SP) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tsa.html">2.4.1. Time Series Analysis (TSA) Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="network.html">2.4.2. Network Representation of Time Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="information.html">2.4.3. Information Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="misc.html">2.4.4. Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MakeData.html">2.5. Make Data (MakeData) Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="PointCloud.html">2.5.1. Point Cloud Data Generation (PointCloud) Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="DynSysLib.html">2.5.2. Dynamic Systems Library (DynSysLib) Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">3. Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#contributing-to-documentation">3.1. Contributing to Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">4. License</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">5. Citing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">teaspoon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html"><span class="section-number">2. </span>Table of Contents</a> &raquo;</li>
          <li><a href="parameter_selection.html"><span class="section-number">2.1. </span>Parameter selection module documentation</a> &raquo;</li>
      <li><span class="section-number">2.1.3. </span>Statistical analysis of the Fourier spectrum for time delay (tau).</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/FSA.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="module-teaspoon.parameter_selection.delay_LMS"></span><div class="section" id="statistical-analysis-of-the-fourier-spectrum-for-time-delay-tau">
<h1><span class="section-number">2.1.3. </span>Statistical analysis of the Fourier spectrum for time delay (tau).<a class="headerlink" href="#statistical-analysis-of-the-fourier-spectrum-for-time-delay-tau" title="Permalink to this headline"></a></h1>
<p>This function a statistical analysis (using the least median of squares) of the fourier spectrum (FFT) from a time series to detect
the greatest signficant frequency, which is then used to select the delay (tau) from the samping rate criteria developed in
On the 0/1 test for chaos in continuous systems by Melosik and Marszalek.</p>
<dl class="function">
<dt id="teaspoon.parameter_selection.delay_LMS.AbsFFT">
<code class="sig-prename descclassname">teaspoon.parameter_selection.delay_LMS.</code><code class="sig-name descname">AbsFFT</code><span class="sig-paren">(</span><em class="sig-param">ts</em>, <em class="sig-param">fs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/teaspoon/parameter_selection/delay_LMS.html#AbsFFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#teaspoon.parameter_selection.delay_LMS.AbsFFT" title="Permalink to this definition"></a></dt>
<dd><p>This function returns the maximum frequency in fourier spectrum given a cutoff threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>array</em>) – Time series (1d).</p></li>
<li><p><strong>fs</strong> – Sampling frequency of time series (equispaced).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="teaspoon.parameter_selection.delay_LMS.LMSforDelay">
<code class="sig-prename descclassname">teaspoon.parameter_selection.delay_LMS.</code><code class="sig-name descname">LMSforDelay</code><span class="sig-paren">(</span><em class="sig-param">ts</em>, <em class="sig-param">fs</em>, <em class="sig-param">plotting=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/teaspoon/parameter_selection/delay_LMS.html#LMSforDelay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#teaspoon.parameter_selection.delay_LMS.LMSforDelay" title="Permalink to this definition"></a></dt>
<dd><p>This function takes a time series (ts) and the sampling frequency (fs) and uses
the fast fourier transform and gaussian noise statistics in the fourier spectrum
(using least median of squares (LMS) in statistical analysis) to determine a suitable
embedding delay for permutation entropy using the theory developed in
On the 0/1 test for chaos in continuous systems by Melosik and Marszalek.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>array</em>) – Time series (1d).</p></li>
<li><p><strong>fs</strong> (<em>float</em>) – Sampling frequency of time series (equispaced).</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Kwargs:</dt><dd><p>plotting (bool): Plotting for user interpretation. defaut is False.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tau, The embedding delay for permutation formation.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(int)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="teaspoon.parameter_selection.delay_LMS.MaximumFrequency">
<code class="sig-prename descclassname">teaspoon.parameter_selection.delay_LMS.</code><code class="sig-name descname">MaximumFrequency</code><span class="sig-paren">(</span><em class="sig-param">xf</em>, <em class="sig-param">yf</em>, <em class="sig-param">cutoff</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/teaspoon/parameter_selection/delay_LMS.html#MaximumFrequency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#teaspoon.parameter_selection.delay_LMS.MaximumFrequency" title="Permalink to this definition"></a></dt>
<dd><p>This function returns the maximum frequency in fourier spectrum given a cutoff threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xf</strong> (<em>array</em>) – frequency array from FFT.</p></li>
<li><p><strong>yf</strong> (<em>array</em>) – normalized FFT values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>maxfreq, the maximum frequency above threshold in fourier spectrum.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(float)</p>
</dd>
</dl>
</dd></dl>

</div>
<p>The following is an example implementing the statistics of gaussian noise in the fourier spectrum and
the sampling criteria from On the 0/1 test for chaos in continuous systems by Melosik and Marszalek
for selecting tau:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">teaspoon.parameter_selection.delay_LMS</span> <span class="kn">import</span> <span class="n">LMSforDelay</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">fs</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="n">tau</span> <span class="o">=</span> <span class="n">LMSforDelay</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">plotting</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delay from Fourier: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tau</span><span class="p">)))</span>
</pre></div>
</div>
<p>Where the output for this example is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Permutation</span> <span class="n">Embedding</span> <span class="n">Delay</span><span class="p">:</span> <span class="mi">19</span>
</pre></div>
</div>
<div class="figure align-default">
<a class="reference internal image-reference" href="_images/LMS_delay_PE_fig.png"><img alt="_images/LMS_delay_PE_fig.png" src="_images/LMS_delay_PE_fig.png" style="width: 286.78000000000003px; height: 155.87px;" /></a>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AC.html" class="btn btn-neutral float-left" title="2.1.2. Auto-correlation for time delay (tau)." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="PAMI.html" class="btn btn-neutral float-right" title="2.1.4. Permutation Auto Mutual Information (PAMI) for time delay (tau)." accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Munch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>